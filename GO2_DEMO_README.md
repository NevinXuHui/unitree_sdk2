# GO2 运动控制 Demo 使用说明

## 简介

`go2_motion_demo` 是一个交互式控制程序，可以实时控制 GO2 机器人的移动和动作切换。

## 编译

使用项目根目录的编译脚本：

```bash
./build.sh
```

或者清理后重新编译：

```bash
./build.sh --clean
```

## 安装

### 方式一：直接运行（无需安装）

```bash
./build/bin/go2_motion_demo <网络接口>
```

示例：
```bash
./build/bin/go2_motion_demo eth0
```

### 方式二：安装到系统目录

安装到默认位置（/opt/unitree_go2）：

```bash
./install.sh
```

安装到指定位置：

```bash
./install.sh -p /usr/local
```

安装后运行：

```bash
/opt/unitree_go2/bin/go2_motion_demo eth0
```

或者（如果创建了符号链接）：

```bash
go2_motion_demo eth0
```

### 卸载

```bash
./uninstall.sh
```

或从指定位置卸载：

```bash
./uninstall.sh -p /usr/local
```

## 控制说明

### 动作命令

| 按键 | 功能 | 说明 |
|------|------|------|
| `1` | 站立 | 让机器人站起来 |
| `2` | 趴下 | 让机器人趴下 |
| `3` | 坐下 | 让机器人坐下 |
| `4` | 恢复站立 | 从异常姿态恢复到正常站立 |
| `5` | 阻尼模式 | 进入阻尼模式（可手动移动关节）|
| `0` | 停止/待机 | 停止所有动作 |

### 移动命令（AWDS 布局，支持长按和短按）

**移动控制特性：**
- ✅ **长按持续移动**：按住按键时机器人会持续移动
- ✅ **松开自动停止**：松开按键后0.5秒自动停止
- ✅ **短按移动一小段**：快速按下松开会移动一小段距离

**键位布局（类似游戏控制）：**
```
    W (前进)
A   S   D
左移 后退 右移

Q/E: 左转/右转
X: 立即停止
```

| 按键 | 功能 | 说明 |
|------|------|------|
| `W` | 前进 | 以 0.3 m/s 速度前进 |
| `A` | 左移 | 以 0.2 m/s 速度左移 |
| `S` | 后退 | 以 0.3 m/s 速度后退 |
| `D` | 右移 | 以 0.2 m/s 速度右移 |
| `Q` | 左转 | 以 0.5 rad/s 角速度左转 |
| `E` | 右转 | 以 0.5 rad/s 角速度右转 |
| `X` | 立即停止 | 立即停止移动并保持站立 |

### 其他命令

| 按键 | 功能 |
|------|------|
| `h` | 显示帮助菜单 |
| `ESC` | 退出程序 |

## 使用流程

1. **启动程序**
   ```bash
   ./build/bin/go2_motion_demo eth0
   ```

2. **让机器人站立**
   - 按 `1` 键，机器人会站起来

3. **控制移动**
   - 按 `W` 键前进
   - 按 `A/D` 键左右移动
   - 按 `S` 键后退
   - 按 `Q/E` 键左右转向
   - 按 `X` 键立即停止

4. **切换动作**
   - 按 `3` 键让机器人坐下
   - 按 `1` 键重新站立
   - 按 `2` 键让机器人趴下

5. **异常恢复**
   - 如果机器人姿态异常，按 `4` 键恢复站立
   - 按 `5` 键进入阻尼模式，可手动调整姿态

6. **退出程序**
   - 按 `ESC` 键或 `Ctrl+C` 退出

## 注意事项

⚠️ **安全提示：**
- 首次使用前，请确保机器人周围有足够的空间
- 控制过程中注意观察机器人状态
- 建议先在安全环境下熟悉各项命令
- 准备好随时按 `0` 键或 `ESC` 键停止程序

⚠️ **运行要求：**
- 确保网络接口名称正确（如 eth0, wlan0 等）
- 确保机器人已开机并连接到同一网络
- 需要有足够的权限访问网络接口

## 技术参数

- 控制频率：200 Hz (dt = 0.005s)
- 前进/后退速度：±0.3 m/s
- 横向移动速度：±0.2 m/s
- 转向角速度：±0.5 rad/s
- 移动控制：
  - 按键松开后自动停止延迟：0.5 秒
  - 支持长按持续移动和短按移动
- 动作持续时间：
  - 趴下动作：2.0 秒
  - 坐下动作：2.0 秒
  - 恢复站立：3.0 秒
  - 表情动作：3.0 秒
  - 舞蹈动作：10.0 秒

> **优化说明**：
> 1. 趴下、坐下等动作会持续发送命令一段时间，确保动作可靠执行完成
> 2. 移动控制采用智能按键检测，支持长按持续移动和短按移动一小段

## 故障排除

**问题：程序无法启动**
- 检查网络接口名称是否正确
- 确认机器人是否开机
- 尝试以 root 权限运行

**问题：按键无响应**
- 确保终端窗口处于激活状态
- 检查是否有其他程序占用了键盘输入

**问题：机器人动作异常**
- 按 `4` 键尝试恢复站立
- 按 `0` 键停止当前动作
- 如果无效，按 `ESC` 退出程序后重启

## 扩展开发

如需修改速度参数或添加新功能，请编辑：
```
example/go2/go2_motion_demo.cpp
```

相关 API 文档请参考 Unitree 官方文档。
